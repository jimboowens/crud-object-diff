{"version":3,"file":"index.js","sources":["../index.js"],"sourcesContent":["/**\n * @module crud-compare\n */\n\n/**\n * Check if two objects are equal\n * @param {Object} a\n * @param {Object} b\n */\nfunction isEqualObject (a, b) {\n  var aProps = Object.getOwnPropertyNames(a);\n  var bProps = Object.getOwnPropertyNames(b);\n  if (aProps.length !== bProps.length) return false;\n\n  for (var i = 0; i < aProps.length; i++) {\n    var propName = aProps[i];\n\n    if (a[propName] !== b[propName]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Compare two arrays of objects, to get the created, updated, and deleted values\n * @param {Object[]} toCompareVals The first array item must be the original array of objects.\n * [originalArray, stateUpdatedArray]\n * @param {String!} key The related key between the objects\n * @returns {{ createdVals: Object[], updatedVals: Object[], deletedVals: Object[] }}\n */\nfunction compareObjectVals (toCompareVals, key) {\n  if (toCompareVals.length !== 2) {\n    throw new Error('Arguments are of the wrong length!');\n  }\n  var createdVals = [];\n  var updatedVals = [];\n  var deletedVals = [];\n  var originalItemKeys = [];\n  var activeItemKeys = [];\n  var originalItem = toCompareVals[0];\n  var activeItem = toCompareVals[1];\n\n  if (!originalItem.length) {\n    return {\n      createdVals: activeItem,\n      updatedVals: [],\n      deletedVals: []\n    };\n  }\n\n  for (var i = 0; i < originalItem.length; i++) {\n    var outerKeyVal = originalItem[i][key];\n    originalItemKeys.push(outerKeyVal);\n\n    for (var j = 0; j < activeItem.length; j++) {\n      if (i === 0) {\n        activeItemKeys.push(activeItem[j][key]);\n      }\n\n      if (i === originalItem.length - 1 && originalItemKeys.indexOf(activeItem[j][key]) === -1) {\n        createdVals.push(activeItem[j]);\n      } else if (originalItem[i][key] === activeItem[j][key] && !isEqualObject(originalItem[i], activeItem[j])) {\n        updatedVals.push(activeItem[j]);\n      }\n    }\n\n    if (activeItemKeys.indexOf(outerKeyVal) === -1) {\n      deletedVals.push(originalItem[i]);\n    }\n  }\n\n  return {\n    createdVals: createdVals,\n    updatedVals: updatedVals,\n    deletedVals: deletedVals\n  };\n}\n\n/**\n * Compare two arrays, to get the created & deleted values\n * @param {Object[]} toCompareVals The first array item must be the original array.\n * [originalArray, stateUpdatedArray]\n * @returns {{ createdVals[], deletedVals[] }}\n */\nfunction compareArrayVals (toCompareVals) {\n  if (toCompareVals.length !== 2) {\n    throw new Error('Arguments are of the wrong length!');\n  }\n  var originalItem = toCompareVals[0];\n  var activeItem = toCompareVals[1];\n\n  if (!originalItem.length) {\n    return {\n      createdVals: activeItem,\n      deletedVals: []\n    };\n  }\n  var deletedVals = originalItem.filter(function (v) {\n    return activeItem.indexOf(v) === -1;\n  });\n  var createdVals = activeItem.filter(function (v) {\n    return originalItem.indexOf(v) === -1;\n  });\n  return {\n    createdVals: createdVals,\n    deletedVals: deletedVals\n  };\n}\n\nexports.isEqualObject = isEqualObject;\nexports.compareArrayVals = compareArrayVals;\nexports.compareObjectVals = compareObjectVals;\n"],"names":["isEqualObject","a","b","aProps","Object","getOwnPropertyNames","bProps","length","i","propName","exports","compareArrayVals","toCompareVals","Error","originalItem","activeItem","createdVals","deletedVals","filter","v","indexOf","compareObjectVals","key","updatedVals","originalItemKeys","activeItemKeys","outerKeyVal","push","j"],"mappings":"AASA,SAASA,EAAeC,EAAGC,GACzB,IAAIC,EAASC,OAAOC,oBAAoBJ,GACpCK,EAASF,OAAOC,oBAAoBH,GACxC,GAAIC,EAAOI,SAAWD,EAAOC,OAAQ,SAErC,IAAK,IAAIC,EAAI,EAAGA,EAAIL,EAAOI,OAAQC,IAAK,CACtC,IAAIC,EAAWN,EAAOK,GAEtB,GAAIP,EAAEQ,KAAcP,EAAEO,GACpB,SAIJ,SAyFFC,QAAQV,cAAgBA,EACxBU,QAAQC,iBA1BR,SAA2BC,GACzB,GAA6B,IAAzBA,EAAcL,OAChB,UAAUM,MAAM,sCAElB,IAAIC,EAAeF,EAAc,GAC7BG,EAAaH,EAAc,GAE/B,IAAKE,EAAaP,OAChB,MAAO,CACLS,YAAaD,EACbE,YAAa,IAGjB,IAAIA,EAAcH,EAAaI,OAAO,SAAUC,GAC9C,OAAkC,IAA3BJ,EAAWK,QAAQD,KAK5B,MAAO,CACLH,YAJgBD,EAAWG,OAAO,SAAUC,GAC5C,OAAoC,IAA7BL,EAAaM,QAAQD,KAI5BF,YAAaA,IAMjBP,QAAQW,kBAjFR,SAA4BT,EAAeU,GACzC,GAA6B,IAAzBV,EAAcL,OAChB,UAAUM,MAAM,sCAElB,IAAIG,EAAc,GACdO,EAAc,GACdN,EAAc,GACdO,EAAmB,GACnBC,EAAiB,GACjBX,EAAeF,EAAc,GAC7BG,EAAaH,EAAc,GAE/B,IAAKE,EAAaP,OAChB,MAAO,CACLS,YAAaD,EACbQ,YAAa,GACbN,YAAa,IAIjB,IAAK,IAAIT,EAAI,EAAGA,EAAIM,EAAaP,OAAQC,IAAK,CAC5C,IAAIkB,EAAcZ,EAAaN,GAAGc,GAClCE,EAAiBG,KAAKD,GAEtB,IAAK,IAAIE,EAAI,EAAGA,EAAIb,EAAWR,OAAQqB,IAC3B,IAANpB,GACFiB,EAAeE,KAAKZ,EAAWa,GAAGN,IAGhCd,IAAMM,EAAaP,OAAS,IAAuD,IAAlDiB,EAAiBJ,QAAQL,EAAWa,GAAGN,IAC1EN,EAAYW,KAAKZ,EAAWa,IACnBd,EAAaN,GAAGc,KAASP,EAAWa,GAAGN,IAAStB,EAAcc,EAAaN,GAAIO,EAAWa,KACnGL,EAAYI,KAAKZ,EAAWa,KAIa,IAAzCH,EAAeL,QAAQM,IACzBT,EAAYU,KAAKb,EAAaN,IAIlC,MAAO,CACLQ,YAAaA,EACbO,YAAaA,EACbN,YAAaA"}